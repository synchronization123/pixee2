import base64
import zlib
import marshal
import textwrap

ROUNDS = 10
INPUT_FILE = "your_script.pyw"
OUTPUT_FILE = "your_script_encrypted.pyw"

# Read original source
with open(INPUT_FILE, "r", encoding="utf-8") as f:
    source = f.read()

# Compile ONCE
code_obj = compile(source, "<protected>", "exec")
data = marshal.dumps(code_obj)

# Encode MANY times
for _ in range(ROUNDS):
    data = zlib.compress(data)
    data = base64.b64encode(data)

# Convert to safe string
payload = data.decode("ascii")

final_code = f"""
import base64, zlib, marshal

data = "{payload}"

data = base64.b64decode(data)
data = zlib.decompress(data)

code = marshal.loads(data)
exec(code)
"""

final_code = textwrap.dedent(final_code)

with open(OUTPUT_FILE, "w", encoding="utf-8") as f:
    f.write(final_code)

print("✔ Encryption successful")
print("✔ Output:", OUTPUT_FILE)